<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS2 Vercel Dashboard</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #111; color: #eee; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .card { background: #222; padding: 20px; margin-bottom: 20px; border-radius: 8px; border: 1px solid #333; }
        input, button { width: 100%; padding: 12px; margin: 5px 0; background: #333; border: 1px solid #444; color: white; border-radius: 4px; box-sizing: border-box; }
        button { background: #0070f3; cursor: pointer; font-weight: bold; }
        button:hover { background: #0060df; }
        #output { background: #000; padding: 15px; height: 300px; overflow-y: auto; font-family: monospace; border: 1px solid #333; color: #4af626; white-space: pre-wrap; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš¡ CS2 RCON Dashboard (Vercel)</h1>
        
        <div class="card">
            <h3>ðŸ”Œ Connection Details</h3>
            <input type="text" id="host" placeholder="Server IP (e.g. 123.45.67.89)">
            <input type="number" id="port" placeholder="Port (e.g. 27015)" value="27015">
            <input type="password" id="password" placeholder="RCON Password">
        </div>

        <div class="card">
            <h3>ðŸ’» Console</h3>
            <div id="output">Ready to connect...</div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="cmd" placeholder="Command (e.g. status)..." onkeypress="if(event.key==='Enter') send()">
                <button style="width: 100px;" onclick="send()">Send</button>
            </div>
        </div>

        <div class="card">
            <h3>âš¡ Quick Actions</h3>
            <div class="grid">
                <button onclick="run('status')">Status</button>
                <button onclick="run('users')">Users</button>
                <button onclick="run('mp_restartgame 1')">Restart Round</button>
                <button onclick="run('changelevel de_mirage')">Map: Mirage</button>
            </div>
        </div>
    </div>

    <script>
        // Load saved credentials
        document.getElementById('host').value = localStorage.getItem('cs2_host') || '';
        document.getElementById('password').value = localStorage.getItem('cs2_pass') || '';

        async function send() {
            const host = document.getElementById('host').value;
            const port = document.getElementById('port').value;
            const password = document.getElementById('password').value;
            const command = document.getElementById('cmd').value;

            if(!host || !password || !command) return alert("Fill all fields!");

            // Save credentials
            localStorage.setItem('cs2_host', host);
            localStorage.setItem('cs2_pass', password);

            log(`> ${command}`);
            document.getElementById('cmd').value = '';

            try {
                const res = await fetch('/api/command', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ host, port, password, command })
                });
                
                const data = await res.json();
                if(data.success) {
                    log(data.response);
                } else {
                    log(`Error: ${data.message}`);
                }
            } catch(e) {
                log(`Network Error: ${e.message}`);
            }
        }

        function run(cmd) {
            document.getElementById('cmd').value = cmd;
            send();
        }

        function log(msg) {
            const out = document.getElementById('output');
            out.innerText += '\n' + msg;
            out.scrollTop = out.scrollHeight;
        }
    </script>
</body>
</html>